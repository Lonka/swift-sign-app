import{a as R}from"./index-8dba5944.js";import{d as q,k as p,p as L,r as Q,o as Z,c as j,e as a,b as A,f as x,q as G,t as $,F as J}from"./index-a0880d2c.js";const k=(v,l)=>(v+l)/2;function C(v,l=!0){const o=v.length;if(o<4)return"";let t=v[0],n=v[1];const h=v[2];let d=`M${t[0].toFixed(2)},${t[1].toFixed(2)} Q${n[0].toFixed(2)},${n[1].toFixed(2)} ${k(n[0],h[0]).toFixed(2)},${k(n[1],h[1]).toFixed(2)} T`;for(let u=2,c=o-1;u<c;u++)t=v[u],n=v[u+1],d+=`${k(t[0],n[0]).toFixed(2)},${k(t[1],n[1]).toFixed(2)} `;return l&&(d+="Z"),d}const K=a("div",{class:"i-carbon-volume-file-storage h-6 w-6"},null,-1),ee=[K],te=a("div",{class:"i-carbon-save h-6 w-6"},null,-1),ne=[te],oe=a("div",{class:"i-carbon-trash-can h-6 w-6"},null,-1),ie=[oe],ae=a("div",{class:"i-carbon-pen h-6 w-6"},null,-1),le=[ae],se=a("div",{class:"i-carbon-pen-fountain h-6 w-6"},null,-1),re=[se],ce={class:"inline-block mx-2 !outline-none"},ue=a("div",{class:"i-carbon-document-signed h-6 w-6"},null,-1),fe=[ue],he=a("div",{class:"i-carbon-clean h-6 w-6"},null,-1),ve=[he],de={class:"border border-dark-500 relative"},g=2,_e=q({__name:"drawBoard",setup(v){const l=p(),o=p();let t=null,n=null;const h=p(0);let d=!1;const u=p([]),c=[],y=p(void 0),m=p("Black"),s=p(),_=p(),b=[];L(()=>{var e,i;t=(e=l.value)==null?void 0:e.getContext("2d"),l.value&&t&&(l.value.width=window.innerWidth-60,l.value.height=window.innerHeight-200,t.fillStyle="rgba(255,255,255)",t.fillRect(0,0,l.value.width,l.value.height)),n=(i=o.value)==null?void 0:i.getContext("2d"),o.value&&n&&(o.value.width=window.innerWidth-60,o.value.height=window.innerHeight-200,n.fillStyle="rgba(255,255,255,0)",n.fillRect(0,0,o.value.width,o.value.height))});const I=e=>{o.value&&n&&n.clearRect(0,0,o.value.width,o.value.height);const i=R(e.points,e.options),f=C(i),r=new Path2D(f);n==null||n.fill(r)},M=e=>{o.value&&n&&n.clearRect(0,0,o.value.width,o.value.height),s.value&&(n==null||n.strokeRect(s.value.x,s.value.y,e.x-s.value.x,e.y-s.value.y))},B=()=>{if(c.length>0){o.value&&n&&n.clearRect(0,0,o.value.width,o.value.height);const e=c[c.length-1],i=C(R(e.points,e.options)),f=new Path2D(i);e.penColor&&(t.fillStyle=e.penColor.toString()),t==null||t.fill(f)}},O=()=>{if(_.value&&s.value){o.value&&n&&n.clearRect(0,0,o.value.width,o.value.height);const e=new Image;e.onload=()=>{_.value&&s.value&&(t==null||t.drawImage(e,s.value.x,s.value.y,_.value.x-s.value.x,_.value.y-s.value.y),b.push({image:e,initialPoint:Object.assign({},s.value),finishPoint:Object.assign({},_.value)}))},e.crossOrigin="anonymous",e.src="/swift-sign-app/signature.png"}},T=()=>{h.value=0,y.value={size:16,smoothing:.5,thinning:.5,streamline:.5,simulatePressure:!1,easing:e=>e,start:{taper:0,cap:!0},end:{taper:0,cap:!0}}},E=()=>{h.value=1,y.value={size:16,smoothing:.5,thinning:.5,streamline:.5,simulatePressure:!0,easing:e=>e,start:{taper:0,cap:!0},end:{taper:0,cap:!0}}},z=()=>{h.value=2},H=()=>{h.value=3},D=()=>{t&&l.value&&(t.clearRect(0,0,l.value.width,l.value.height),t.fillStyle="rgba(255,255,255)",t.fillRect(0,0,l.value.width,l.value.height))},F=()=>{c.forEach(e=>{const i=C(R(e.points,e.options)),f=new Path2D(i);e.penColor&&(t.fillStyle=e.penColor.toString()),t==null||t.fill(f)}),b.forEach(e=>t==null?void 0:t.drawImage(e.image,e.initialPoint.x,e.initialPoint.y,e.finishPoint.x-e.initialPoint.x,e.finishPoint.y-e.initialPoint.y))},N=()=>{},X=e=>{if(e.preventDefault(),d=!0,o.value&&n)switch(h.value){case 0:case 1:u.value.length=0,n.fillStyle=m.value.toString(),u.value.push({x:e.offsetX,y:e.offsetY,p:e.pressure}),c.push({options:Object.assign({},y.value),points:[{x:e.offsetX,y:e.offsetY,p:e.pressure}],penColor:m.value});break;case 3:s.value={x:e.offsetX,y:e.offsetY};break}},U=e=>{let i=-1,f=!1;if(d&&e.buttons===1)switch(e.preventDefault(),h.value){case 0:case 1:u.value.push({x:e.offsetX,y:e.offsetY,p:e.pressure}),c[c.length-1].points.push({x:e.offsetX,y:e.offsetY,p:e.pressure}),I({points:u.value,options:y.value});break;case 3:_.value={x:e.offsetX,y:e.offsetY},M(_.value);break;case 2:for(let r=0;r<c.length;r++){const w=c[r];for(let S=0;S<w.points.length;S++){const P=w.points[S];if(P.x+g>=e.offsetX&&P.x-g<=e.offsetX&&P.y+g>=e.offsetY&&P.y-g<=e.offsetY){i=r;break}}if(i>-1)break}i>-1&&(c.splice(i,1),f=!0),i=-1;for(let r=0;r<b.length;r++){const w=b[r];if(w.initialPoint.x-g<=e.offsetX&&w.finishPoint.x+g>=e.offsetX&&w.initialPoint.y-g<=e.offsetY&&w.initialPoint.y+g>=e.offsetY){i=r;break}}i>-1&&(b.splice(i,1),f=!0),i=-1,f&&(D(),F());break}},Y=e=>{switch(e.preventDefault(),d=!1,h.value){case 0:case 1:B();break;case 3:O();break}},V=e=>{e.buttons===1&&X(e)},W=e=>{d&&Y(e)};return(e,i)=>{const f=Q("color-picker");return Z(),j(J,null,[a("div",null,[a("div",{class:"icon-btn mx-2 !outline-none",onClick:F},ee),a("div",{class:"icon-btn mx-2 !outline-none",onClick:N},ne),a("div",{class:"icon-btn mx-2 !outline-none",onClick:D},ie),a("div",{class:"icon-btn mx-2 !outline-none",onClick:T},le),a("div",{class:"icon-btn mx-2 !outline-none",onClick:E},re),a("div",ce,[A(f,{pureColor:x(m),"onUpdate:pureColor":i[0]||(i[0]=r=>G(m)?m.value=r:null),class:"w-6"},null,8,["pureColor"])]),a("div",{class:"icon-btn mx-2 !outline-none",onClick:H},fe),a("div",{class:"icon-btn mx-2 !outline-none",onClick:z},ve)]),a("p",null,$(x(m)),1),a("p",null,$(x(u)[x(u).length-1]),1),a("div",de,[a("canvas",{ref_key:"canvasDraftRef",ref:o,style:{"touch-action":"none","user-select":"none"},class:"absolute",onPointerdown:X,onPointermove:U,onPointerup:Y,onPointerenter:V,onPointerleave:W},null,544),a("canvas",{ref_key:"canvasRef",ref:l},null,512)])],64)}}});export{_e as default};
