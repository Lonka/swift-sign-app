import{a as R}from"./index-8dba5944.js";import{d as V,k as p,p as W,r as q,o as L,c as Q,e as a,b as Z,f as j,q as A,F as G}from"./index-95e8ee09.js";const x=(h,l)=>(h+l)/2;function S(h,l=!0){const o=h.length;if(o<4)return"";let t=h[0],n=h[1];const f=h[2];let d=`M${t[0].toFixed(2)},${t[1].toFixed(2)} Q${n[0].toFixed(2)},${n[1].toFixed(2)} ${x(n[0],f[0]).toFixed(2)},${x(n[1],f[1]).toFixed(2)} T`;for(let v=2,u=o-1;v<u;v++)t=h[v],n=h[v+1],d+=`${x(t[0],n[0]).toFixed(2)},${x(t[1],n[1]).toFixed(2)} `;return l&&(d+="Z"),d}const J=a("div",{class:"i-carbon-volume-file-storage h-6 w-6"},null,-1),K=[J],ee=a("div",{class:"i-carbon-save h-6 w-6"},null,-1),te=[ee],ne=a("div",{class:"i-carbon-trash-can h-6 w-6"},null,-1),oe=[ne],ie=a("div",{class:"i-carbon-pen h-6 w-6"},null,-1),ae=[ie],le=a("div",{class:"i-carbon-pen-fountain h-6 w-6"},null,-1),se=[le],re={class:"inline-block mx-2 !outline-none"},ce=a("div",{class:"i-carbon-document-signed h-6 w-6"},null,-1),ue=[ce],fe=a("div",{class:"i-carbon-clean h-6 w-6"},null,-1),he=[fe],ve={class:"border border-dark-500 relative"},g=2,ge=V({__name:"drawBoard",setup(h){const l=p(),o=p();let t=null,n=null;const f=p(0);let d=!1;const v=p([]),u=[],m=p(void 0),b=p("Black"),s=p(),_=p(),P=[];W(()=>{var e,i;t=(e=l.value)==null?void 0:e.getContext("2d"),l.value&&t&&(l.value.width=window.innerWidth-60,l.value.height=window.innerHeight-200,t.fillStyle="rgba(255,255,255)",t.fillRect(0,0,l.value.width,l.value.height)),n=(i=o.value)==null?void 0:i.getContext("2d"),o.value&&n&&(o.value.width=window.innerWidth-60,o.value.height=window.innerHeight-200,n.fillStyle="rgba(255,255,255,0)",n.fillRect(0,0,o.value.width,o.value.height)),m.value={size:13,smoothing:.5,thinning:.5,streamline:.5,easing:r=>1-Math.cos(r*Math.PI/2),start:{taper:0,cap:!0},end:{taper:1,cap:!0}}});const X=e=>{o.value&&n&&n.clearRect(0,0,o.value.width,o.value.height);const i=R(e.points,e.options),r=S(i),c=new Path2D(r);n==null||n.fill(c)},Y=e=>{o.value&&n&&n.clearRect(0,0,o.value.width,o.value.height),s.value&&(n==null||n.strokeRect(s.value.x,s.value.y,e.x-s.value.x,e.y-s.value.y))},I=()=>{if(u.length>0){o.value&&n&&n.clearRect(0,0,o.value.width,o.value.height);const e=u[u.length-1],i=S(R(e.points,e.options)),r=new Path2D(i);e.penColor&&(t.fillStyle=e.penColor.toString()),t==null||t.fill(r)}},$=()=>{if(_.value&&s.value){o.value&&n&&n.clearRect(0,0,o.value.width,o.value.height);const e=new Image;e.onload=()=>{_.value&&s.value&&(t==null||t.drawImage(e,s.value.x,s.value.y,_.value.x-s.value.x,_.value.y-s.value.y),P.push({image:e,initialPoint:Object.assign({},s.value),finishPoint:Object.assign({},_.value)}))},e.crossOrigin="anonymous",e.src="/swift-sign-app/signature.png"}},B=()=>{f.value=0,m.value={size:16,smoothing:.5,thinning:.5,streamline:.5,easing:e=>e,start:{taper:0,cap:!0},end:{taper:0,cap:!0}}},O=()=>{f.value=1,m.value={size:13,smoothing:.5,thinning:.5,streamline:.5,easing:e=>1-Math.cos(e*Math.PI/2),start:{taper:0,cap:!0},end:{taper:1,cap:!0}}},T=()=>{f.value=2},E=()=>{f.value=3},C=()=>{t&&l.value&&(t.clearRect(0,0,l.value.width,l.value.height),t.fillStyle="rgba(255,255,255)",t.fillRect(0,0,l.value.width,l.value.height))},D=()=>{u.forEach(e=>{const i=S(R(e.points,e.options)),r=new Path2D(i);e.penColor&&(t.fillStyle=e.penColor.toString()),t==null||t.fill(r)}),P.forEach(e=>t==null?void 0:t.drawImage(e.image,e.initialPoint.x,e.initialPoint.y,e.finishPoint.x-e.initialPoint.x,e.finishPoint.y-e.initialPoint.y))},z=()=>{},F=e=>{if(e.preventDefault(),d=!0,o.value&&n)switch(f.value){case 0:case 1:v.value.length=0,n.fillStyle=b.value.toString(),v.value.push({x:e.offsetX,y:e.offsetY,p:e.pressure}),u.push({options:Object.assign({},m.value),points:[{x:e.offsetX,y:e.offsetY,p:e.pressure}],penColor:b.value});break;case 3:s.value={x:e.offsetX,y:e.offsetY};break}},H=e=>{let i=-1,r=!1;if(d&&e.buttons===1)switch(e.preventDefault(),f.value){case 0:case 1:v.value.push({x:e.offsetX,y:e.offsetY,p:e.pressure}),u[u.length-1].points.push({x:e.offsetX,y:e.offsetY,p:e.pressure}),X({points:v.value,options:m.value});break;case 3:_.value={x:e.offsetX,y:e.offsetY},Y(_.value);break;case 2:for(let c=0;c<u.length;c++){const w=u[c];for(let k=0;k<w.points.length;k++){const y=w.points[k];if(y.x+g>=e.offsetX&&y.x-g<=e.offsetX&&y.y+g>=e.offsetY&&y.y-g<=e.offsetY){i=c;break}}if(i>-1)break}i>-1&&(u.splice(i,1),r=!0),i=-1;for(let c=0;c<P.length;c++){const w=P[c];if(w.initialPoint.x-g<=e.offsetX&&w.finishPoint.x+g>=e.offsetX&&w.initialPoint.y-g<=e.offsetY&&w.initialPoint.y+g>=e.offsetY){i=c;break}}i>-1&&(P.splice(i,1),r=!0),i=-1,r&&(C(),D());break}},M=e=>{switch(e.preventDefault(),d=!1,f.value){case 0:case 1:I();break;case 3:$();break}},N=e=>{e.buttons===1&&F(e)},U=e=>{d&&M(e)};return(e,i)=>{const r=q("color-picker");return L(),Q(G,null,[a("div",null,[a("div",{class:"icon-btn mx-2 !outline-none",onClick:D},K),a("div",{class:"icon-btn mx-2 !outline-none",onClick:z},te),a("div",{class:"icon-btn mx-2 !outline-none",onClick:C},oe),a("div",{class:"icon-btn mx-2 !outline-none",onClick:B},ae),a("div",{class:"icon-btn mx-2 !outline-none",onClick:O},se),a("div",re,[Z(r,{pureColor:j(b),"onUpdate:pureColor":i[0]||(i[0]=c=>A(b)?b.value=c:null),class:"w-6"},null,8,["pureColor"])]),a("div",{class:"icon-btn mx-2 !outline-none",onClick:E},ue),a("div",{class:"icon-btn mx-2 !outline-none",onClick:T},he)]),a("div",ve,[a("canvas",{ref_key:"canvasDraftRef",ref:o,style:{"touch-action":"none","user-select":"none"},class:"absolute",onPointerdown:F,onPointermove:H,onPointerup:M,onPointerenter:N,onPointerleave:U},null,544),a("canvas",{ref_key:"canvasRef",ref:l},null,512)])],64)}}});export{ge as default};
