import{a as S}from"./index-8dba5944.js";import{d as j,j as p,m as L,r as Q,o as Z,c as q,e as a,b as A,f as C,n as G,t as Y,F as J}from"./index-26eb796f.js";const x=(h,l)=>(h+l)/2;function R(h,l=!0){const o=h.length;if(o<4)return"";let t=h[0],n=h[1];const u=h[2];let d=`M${t[0].toFixed(2)},${t[1].toFixed(2)} Q${n[0].toFixed(2)},${n[1].toFixed(2)} ${x(n[0],u[0]).toFixed(2)},${x(n[1],u[1]).toFixed(2)} T`;for(let v=2,r=o-1;v<r;v++)t=h[v],n=h[v+1],d+=`${x(t[0],n[0]).toFixed(2)},${x(t[1],n[1]).toFixed(2)} `;return l&&(d+="Z"),d}const K=a("div",{class:"i-carbon-volume-file-storage h-6 w-6"},null,-1),ee=[K],ne=a("div",{class:"i-carbon-save h-6 w-6"},null,-1),te=[ne],oe=a("div",{class:"i-carbon-trash-can h-6 w-6"},null,-1),ie=[oe],ae=a("div",{class:"i-carbon-pen h-6 w-6"},null,-1),le=[ae],se=a("div",{class:"i-carbon-pen-fountain h-6 w-6"},null,-1),ce=[se],re={class:"inline-block mx-2 !outline-none"},ue=a("div",{class:"i-carbon-document-signed h-6 w-6"},null,-1),fe=[ue],he=a("div",{class:"i-carbon-clean h-6 w-6"},null,-1),ve=[he],de={class:"border border-dark-500 relative"},g=2,_e=j({__name:"drawBoard",setup(h){const l=p(),o=p();let t=null,n=null;const u=p(0);let d=!1;const v=p([]),r=[],P=p(void 0),m=p("Black"),s=p(),_=p(),y=[];L(()=>{var e,i;t=(e=l.value)==null?void 0:e.getContext("2d"),l.value&&t&&(l.value.width=window.innerWidth,l.value.height=window.innerHeight-60,t.fillStyle="rgba(255,255,255)",t.fillRect(0,0,l.value.width,l.value.height)),n=(i=o.value)==null?void 0:i.getContext("2d"),o.value&&n&&(o.value.width=window.innerWidth,o.value.height=window.innerHeight-60,n.fillStyle="rgba(255,255,255,0)",n.fillRect(0,0,o.value.width,o.value.height))});const $=e=>{o.value&&n&&n.clearRect(0,0,o.value.width,o.value.height);const i=S(e.points,e.options),f=R(i),c=new Path2D(f);n==null||n.fill(c)},I=e=>{o.value&&n&&n.clearRect(0,0,o.value.width,o.value.height),s.value&&(n==null||n.strokeRect(s.value.x,s.value.y,e.x-s.value.x,e.y-s.value.y))},M=()=>{if(r.length>0){o.value&&n&&n.clearRect(0,0,o.value.width,o.value.height);const e=r[r.length-1],i=R(S(e.points,e.options)),f=new Path2D(i);e.penColor&&(t.fillStyle=e.penColor.toString()),t==null||t.fill(f)}},B=()=>{if(_.value&&s.value){o.value&&n&&n.clearRect(0,0,o.value.width,o.value.height);const e=new Image;e.onload=()=>{_.value&&s.value&&(t==null||t.drawImage(e,s.value.x,s.value.y,_.value.x-s.value.x,_.value.y-s.value.y),y.push({image:e,initialPoint:Object.assign({},s.value),finishPoint:Object.assign({},_.value)}))},e.crossOrigin="anonymous",e.src="/swift-sign-app/signature.png"}},O=()=>{u.value=0,P.value={size:8,thinning:.5,streamline:.5,smoothing:.5,last:!0}},T=()=>{u.value=1,P.value={size:16,smoothing:.5,thinning:.5,streamline:.5,easing:e=>e,start:{taper:0,cap:!0},end:{taper:0,cap:!0}}},E=()=>{u.value=2},z=()=>{u.value=3},F=()=>{t&&l.value&&t.clearRect(0,0,l.value.width,l.value.height)},D=()=>{r.forEach(e=>{const i=R(S(e.points,e.options)),f=new Path2D(i);e.penColor&&(t.fillStyle=e.penColor.toString()),t==null||t.fill(f)}),y.forEach(e=>t==null?void 0:t.drawImage(e.image,e.initialPoint.x,e.initialPoint.y,e.finishPoint.x-e.initialPoint.x,e.finishPoint.y-e.initialPoint.y))},H=()=>{},N=e=>{if(d=!0,o.value&&n)switch(u.value){case 0:case 1:v.value.length=0,n.fillStyle=m.value.toString(),v.value.push({x:e.offsetX,y:e.offsetY,p:e.pressure}),r.push({options:Object.assign({},P.value),points:[{x:e.offsetX,y:e.offsetY,p:e.pressure}],penColor:m.value});break;case 3:s.value={x:e.offsetX,y:e.offsetY};break}},U=e=>{let i=-1,f=!1;if(d)switch(u.value){case 0:case 1:v.value.push({x:e.offsetX,y:e.offsetY,p:e.pressure}),r[r.length-1].points.push({x:e.offsetX,y:e.offsetY,p:e.pressure}),$({points:v.value,options:P.value});break;case 3:_.value={x:e.offsetX,y:e.offsetY},I(_.value);break;case 2:for(let c=0;c<r.length;c++){const w=r[c];for(let k=0;k<w.points.length;k++){const b=w.points[k];if(b.x+g>=e.offsetX&&b.x-g<=e.offsetX&&b.y+g>=e.offsetY&&b.y-g<=e.offsetY){i=c;break}}if(i>-1)break}i>-1&&(r.splice(i,1),f=!0),i=-1;for(let c=0;c<y.length;c++){const w=y[c];if(w.initialPoint.x-g<=e.offsetX&&w.finishPoint.x+g>=e.offsetX&&w.initialPoint.y-g<=e.offsetY&&w.initialPoint.y+g>=e.offsetY){i=c;break}}i>-1&&(y.splice(i,1),f=!0),i=-1,f&&(F(),D());break}},X=e=>{switch(d=!1,u.value){case 0:case 1:M();break;case 3:B();break}},V=e=>{},W=e=>{d&&X()};return(e,i)=>{const f=Q("color-picker");return Z(),q(J,null,[a("div",null,[a("div",{class:"icon-btn mx-2 !outline-none",onClick:D},ee),a("div",{class:"icon-btn mx-2 !outline-none",onClick:H},te),a("div",{class:"icon-btn mx-2 !outline-none",onClick:F},ie),a("div",{class:"icon-btn mx-2 !outline-none",onClick:O},le),a("div",{class:"icon-btn mx-2 !outline-none",onClick:T},ce),a("div",re,[A(f,{pureColor:C(m),"onUpdate:pureColor":i[0]||(i[0]=c=>G(m)?m.value=c:null),class:"w-6"},null,8,["pureColor"])]),a("div",{class:"icon-btn mx-2 !outline-none",onClick:z},fe),a("div",{class:"icon-btn mx-2 !outline-none",onClick:E},ve)]),a("p",null,Y(C(m)),1),a("p",null,Y(C(u)),1),a("div",de,[a("canvas",{ref_key:"canvasDraftRef",ref:o,class:"absolute",onPointerdown:N,onPointermove:U,onPointerup:X,onPointerenter:V,onPointerleave:W},null,544),a("canvas",{ref_key:"canvasRef",ref:l},null,512)])],64)}}});export{_e as default};
